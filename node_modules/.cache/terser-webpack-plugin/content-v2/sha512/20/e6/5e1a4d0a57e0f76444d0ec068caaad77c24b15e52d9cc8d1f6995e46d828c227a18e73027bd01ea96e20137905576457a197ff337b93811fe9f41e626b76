{"code":"!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\"/\",t(t.s=3)}([function(e,n){e.exports=require(\"fs\")},function(e,n){e.exports=require(\"path\")},function(e,n){e.exports=require(\"express\")},function(e,n,t){var r=t(2),o=t(0),u=t(4),i=r(),a=t(1);i.use(r.json()),i.use(\"/\",r.static(\"./dist/public\")),i.use(\"/api/cart\",u);var c=a.resolve(__dirname,\"db/products.json\");i.get(\"/api/products\",(function(e,n){o.readFile(c,\"utf-8\",(function(e,t){e?n.send(JSON.stringify({result:0,text:e})):n.send(t)}))}));var s=process.env.PORT||3e3;i.listen(s,(function(){console.log(\"Server started at port \".concat(s))}))},function(e,n,t){var r=t(2),o=t(0),u=t(5),i=r.Router(),a=t(1).resolve(__dirname,\"db/userCart.json\");i.get(\"/\",(function(e,n){o.readFile(a,\"utf-8\",(function(e,t){e?n.sendStatus(404,JSON.stringify({result:0,text:e})):n.send(t)}))})),i.post(\"/\",(function(e,n){u(e,n,\"add\",a)})),i.put(\"/:id\",(function(e,n){u(e,n,\"change\",a)})),i.delete(\"/:id\",(function(e,n){u(e,n,\"remove\",a)})),i.delete(\"/\",(function(e,n){u(e,n,\"clear\",a)})),e.exports=i},function(e,n,t){var r=t(0),o=t(6),u=t(7),i={add:o.add,change:o.change,remove:o.remove,clear:o.clear};e.exports=function(e,n,t,o){r.readFile(o,\"utf-8\",(function(a,c){if(a)n.sendStatus(404,JSON.stringify({result:0,text:a}));else{var s=i[t](JSON.parse(c),e),f=s.name,d=s.newCart;r.writeFile(o,d,(function(e){e?n.send('{\"result\": 0}'):(u(f,t),n.send('{\"result\": 1}'))}))}}))}},function(e,n){e.exports={add:function(e,n){return e.contents.push(n.body),e.amount=e.amount+n.body.price,{name:n.body.product_name,newCart:JSON.stringify(e,null,4)}},change:function(e,n){var t=e.contents.find((function(e){return e.id_product===+n.params.id}));return t.quantity+=n.body.quantity,n.body.quantity<0?e.amount=e.amount-t.price:e.amount=e.amount+t.price,{name:n.body.product_name,newCart:JSON.stringify(e,null,4)}},remove:function(e,n){var t=e.contents.find((function(e){return e.id_product===+n.params.id}));return e.amount-=t.price,e.contents.splice(e.contents.indexOf(t),1),{name:n.body.product_name,newCart:JSON.stringify(e,null,4)}},clear:function(e,n){return e.contents.length=0,e.amount=0,{name:\"Cart clearing\",newCart:JSON.stringify(e,null,4)}}}},function(e,n,t){var r=t(8),o=t(0),u=t(1).resolve(__dirname,\"db/stats.json\");e.exports=function(e,n){o.readFile(u,\"utf-8\",(function(t,i){if(t)console.log(t);else{var a=JSON.parse(i);a.push({time:r().format(\"DD MMM YYYY, h:mm:ss a\"),prod_name:e,action:n}),o.writeFile(u,JSON.stringify(a,null,4),(function(e){e&&console.log(e)}))}}))}},function(e,n){e.exports=require(\"moment\")}]);","extractedComments":[]}